{% extends 'mobileBase.html' %}
{% load static %}
{% block mobile_title %}
  Home | Start!
{% endblock mobile_title %}

{% block mobile_extrahead %}
  <link rel="stylesheet" type="text/css" href="{% static "css/main/home.css"%}">
{% endblock mobile_extrahead %}

{% block mobile_content%}
  {% if not user.nickname %}
    <div id="profile-unset">
      <p class="signin-complete">회원가입이 완료되었습니다!</p>
      <div class="welcome-box">
        <img src="{% static "images/welcome-box.png" %}" alt="welcome-img">
      </div>
      <p class="wel-message">이제 릴렌즈와<br>스트레스 해소법을 찾아보아요!</p>
      <a href="{% url 'user:content' %}" class="user-button" id="profile_setting">프로필 설정하기</a>
      <a href="{% url 'user:signout' %}" class="user-button" id="log_out">로그아웃하기</a>
    </div>
  {% else %}
    <div id="profile-set">
      <div class="page-wrapper">
        <div class="profile-section">

          <div class="profile-wrapper">
            <div class="profile-circle">
              <div class="back-hair"></div>
              <div class="face"></div>
              <div class="front-hair"></div>
              <div class="eyebrows"></div>
              <div class="eyes"></div>
              <div class="nose"></div>
              <div class="mouth"></div>
              <div class="makeup"></div>
              <div class="clothes"></div>
              <div class="acc"></div>
            </div>
          </div>

          <div class="bubble">
            <div class="triangle"><img src="{%static 'icons/triangleforbubble.png'%}" alt=""></div>
            <div class="circle"><p>{{ user.nickname }}님에게 도착한 오늘의 한마디 &#128172;<p></div>
            <div class="hidden-message"><p>오늘도 화이팅!<p></div>
          </div>
          <div class="badge-section"></div>

        </div>
        <div id="top-page">
          <div class="top-page-content">
            <div class="header-message">
              <img src="{% static "icons/dot.png" %}" alt="">
              <span>{{ user.nickname }}님께 추천하는 관리 활동입니다.</br>마음에 드는 릴렌지를 시도해보아요!</span>
            </div>
            <div class="relenge-section">
              <ul class="tag-list">
                {% comment %} 임시 {% endcomment %}
                <li>전체</li>
                <li>야외</li>
                <li>실내</li>
                <li>동적인</li>
                <li>정적인</li>
                <li>혼자서</li>
                {% comment %} {% for item in tag_list %}
                  <li>{{item}}</li>
                {% endfor %} {% endcomment %}
                
              </ul>
              <div class="relenge-list-container">
                <ul class="relenge-list">
                  {% comment %} 임시 {% endcomment %}
                  <li>전체</li>
                  <li>야외</li>
                  <li>실내</li>
                  <li>동적인</li>
                  <li>정적인</li>
                  <li>혼자서</li>
                </ul>
              </div>
            </div>
            <div class="report-section">
              <div class="report-header">
                <div class="report-title"></div>
                <div class="weekly-monthly"></div>
              </div>
              <div class="report-summary">
                <div class="summary-block"></div>
                <div class="summary-detail-1"></div>
                <div class="summary-detail-2"></div>
              </div>
              <div class="relanz-magazine">
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  {% endif %}
{% endblock %}


{% block mobile-scripts %}
  <script>
    function renderProfileCombination(combinationData) {
      const backHairElement = document.querySelector(".back-hair");
      const frontHairElement = document.querySelector(".front-hair");
      const eyebrowsElement = document.querySelector(".eyebrows");
      const eyesElement = document.querySelector(".eyes");
      const noseElement = document.querySelector(".nose");
      const mouthElement = document.querySelector(".mouth");
      const cheekElement = document.querySelector(".makeup");
      const faceElement = document.querySelector(".face");
      const clothesElement = document.querySelector(".clothes");
      const accElement = document.querySelector(".acc");
    
      // 각 조합 요소의 숫자에 해당하는 이미지 경로 설정
      frontHairElement.style.backgroundImage = `url("{% static 'character/fronthair/fronthair' %}${combinationData[0]}.png")`;
      if (combinationData[1] > 0)
        backHairElement.style.backgroundImage = `url("{% static 'character/backhair/backhair' %}${combinationData[1]}.png")`;
      eyebrowsElement.style.backgroundImage = `url("{% static 'character/brows/brows' %}${combinationData[2]}.png")`;
      eyesElement.style.backgroundImage = `url("{% static 'character/eyes/eyes' %}${combinationData[3]}.png")`;
      noseElement.style.backgroundImage = `url("{% static 'character/nose/nose' %}${combinationData[4]}.png")`;
      mouthElement.style.backgroundImage = `url("{% static 'character/mouth/mouth' %}${combinationData[5]}.png")`;
      if (combinationData[6] > 0)
        cheekElement.style.backgroundImage = `url("{% static 'character/makeup/makeup' %}${combinationData[6]}.png")`;
      faceElement.style.backgroundImage = `url("{% static 'character/face.png' %}")`;
      clothesElement.style.backgroundImage = `url("{% static 'character/clothes/clothes' %}${combinationData[7]}.png")`;
      if (combinationData[8] > 0)
        accElement.style.backgroundImage = `url("{% static 'character/acc/acc' %}${combinationData[8]}.png")`;

    }
    
    
    // 조합 데이터를 적용하여 프로필 렌더링
    //console.log({{user.avatar}})
    renderProfileCombination("{{user.avatar}}");
    
    //오늘의 메세지 전환 효과
    const bubble = document.querySelector('.bubble');
    const bubbleMessage = document.querySelector('.bubble > .circle > p');
    const hiddenMessage = document.querySelector('.hidden-message');
    const triangle = document.querySelector('.bubble .triangle');
    const circle = document.querySelector('.bubble .circle');
    
    bubble.addEventListener('click', function() {

      const isBubbleClicked = bubble.classList.contains('clicked');
      if (isBubbleClicked) {
        bubble.classList.remove('clicked');
        bubble.classList.add('unclicked');
        bubbleMessage.style.display = 'block';
        hiddenMessage.style.display = 'none';
      }
      else {
        bubble.classList.add('clicked');
        bubble.classList.remove('unclicked');
        bubbleMessage.style.display = 'none';
        hiddenMessage.style.display = 'flex';
      }

    });
   
  </script>
{% endblock %}



<!-- {% for challenge in challenges %}
              <hr>
              {{challenge.title}}
{% if challenge.image %}
<img src="{% static challenge.image %}" alt="이미지">
{% endif %}
              
              <a href="{% url 'challenge:challenge' challenge.id %}">참여하기</a>
            {% endfor %} -->
            <!-- 세션 때 블로그 목록 보여주듯이 챌린지 목록을 보여줌 -->
